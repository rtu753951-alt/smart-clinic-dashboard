# 系統啟動封面頁（Launch Cover）使用說明

## 功能概述

系統啟動封面頁為「2026 醫美經營智慧大腦」提供了優雅的啟動體驗，展示三個核心 KPI，並具備營運平衡感的設計。

## 核心功能

### 1. Dynamic Data（動態數據）

封面頁顯示三個核心 KPI，數據口徑與主儀表板完全一致：

#### **月營收（monthlyRevenue）**

- **計算規則**：本月區間內所有 `status === 'completed'` 且 `date <= 今日` 的預約營收總和
- **顯示格式**：`NT$ xxx,xxx`
- **資料來源**：`dataStore.appointments` + `dataStore.services`

#### **核心 VIP 人數（vipCount）**

- **計算規則**：使用 RFM 分群邏輯
  - **Champions**：R >= 4, F >= 4, M >= 平均消費
  - **Loyal Customers**：R >= 3, F >= 5, M >= 平均消費
- **時間窗**：固定使用當前日期計算 Recency
- **顯示格式**：`XX 位`

#### **風險客群總數（riskCount）**

- **計算規則**：與「查看流失風險名單」完全一致
  - 預約次數 >= 2（排除一次性過路客）
  - 未回診天數在 30-180 天之間
  - 顧客去重
- **顯示格式**：`XX 名`

### 2. Balanced UI（平衡版面）

#### 頂部標題

- **文字**：「2026 醫美經營智慧大腦｜啟動中心」
- **樣式**：漸層文字效果（藍-紫）

#### 兩欄卡片佈局

- **左側（亮點區）**：佔 60% 寬度

  - 顯示：月營收 + VIP 人數
  - 色系：藍色系 (#2563EB)
  - 風格：專業、穩定

- **右側（行動區）**：佔 40% 寬度
  - 顯示：風險客群數
  - 標籤：「本日優先行動建議」
  - 色系：溫和橘 (#F59E0B)
  - 風格：提示、引導

#### 卡片對齊

- 兩欄同高對齊
- 垂直置中顯示內容
- 響應式設計（小螢幕自動改為單欄）

### 3. Enter Ritual（進入儀式）

#### 主按鈕

- **文字**：「開始今日數據決策」
- **樣式**：藍色漸層 + 箭頭圖示
- **互動**：hover 時上浮 + 箭頭右移

#### 過場動畫

- **淡出時間**：400ms（ease-out）
- **效果**：opacity 從 1 到 0
- **完成後**：隱藏封面，顯示主儀表板

#### 載入狀態

- **Skeleton 動畫**：shimmer 效果
- **提示文字**：「正在同步今日營運指標…」
- **Loading 圖示**：旋轉圓環

#### 錯誤處理

- **顯示錯誤訊息**：若資料載入失敗
- **離線模式**：仍可進入系統（使用快取或顯示 --）
- **按鈕文字**：「繼續使用離線模式」

## 技術架構

### 檔案結構

```
src/
  pages/
    launchCoverPage.ts         # 封面頁邏輯
  styles/
    launchCover.css            # 封面頁樣式
  main.ts                      # 主入口（已整合）

index.html                     # HTML 容器
```

### 資料流程

1. **DOMContentLoaded** 事件觸發
2. 呼叫 `initLaunchCover()`
3. 載入資料 `dataStore.loadAll()`
4. 計算三個 KPI
5. 渲染封面內容
6. 使用者點擊進入按鈕
7. 封面淡出動畫（400ms）
8. 顯示主儀表板

### 關鍵函式

#### `initLaunchCover()`

- 初始化封面頁
- 顯示 loading 狀態
- 載入資料並計算 KPI
- 渲染內容或錯誤狀態

#### `calculateLaunchCoverData()`

- 計算三個核心 KPI
- 回傳格式化的資料物件
- 處理異常狀況

#### `renderCoverContent()`

- 渲染封面內容（成功狀態）
- 顯示 KPI 數據
- 綁定進入按鈕

#### `bindEnterButton()`

- 綁定按鈕點擊事件
- 執行淡出動畫
- 切換到主儀表板

## 樣式設計特色

### 色彩系統

- **背景**：深藍漸層 (#0f172a → #1e293b)
- **亮點區**：藍色調 (#2563EB)
- **行動區**：橘色調 (#F59E0B)
- **文字**：淺色系 (#f8fafc, #cbd5e1)

### 動畫效果

- **進入動畫**：fadeInUp（600ms）
- **退出動畫**：opacity 淡出（400ms）
- **Skeleton**：shimmer 滑動效果
- **Loading**：旋轉動畫

### 響應式設計

- **桌面版**：兩欄佈局（60% + 40%）
- **平板/手機**：單欄佈局
- **字體大小**：自適應調整

## 資料口徑一致性

### 與主儀表板的對應關係

| KPI      | 封面頁函式                   | 主儀表板對應                                    | 計算口徑                       |
| -------- | ---------------------------- | ----------------------------------------------- | ------------------------------ |
| 月營收   | `calculateLaunchCoverData()` | `overviewPage.ts: updateMonthlyRevenue()`       | 相同（本月 completed）         |
| VIP 人數 | `calculateVIPCount()`        | `customersPage.ts: renderRFMSegmentChart()`     | 相同（RFM Champions + Loyal）  |
| 風險客群 | `calculateRiskCount()`       | `customersPage.ts: getCoreChurnRiskCustomers()` | 相同（2+ visits, 30-180 days） |

### 資料新鮮度

- 所有 KPI 均使用即時資料
- 不依賴快取或預先計算
- 與主儀表板保持同步

## 使用方式

### 開發環境

```bash
npm run build    # 編譯 TypeScript
npm start        # 啟動開發伺服器（如果有）
```

### 生產環境

封面頁會在系統載入時自動顯示，無需額外設定。

### 自訂設定

如需調整封面頁行為，可修改以下檔案：

1. **調整 KPI 定義**：`src/pages/launchCoverPage.ts`
2. **修改樣式風格**：`src/styles/launchCover.css`
3. **變更進入動畫**：`launchCover.css` 中的 `@keyframes`

## 注意事項

1. **資料口徑**：絕不可修改 KPI 計算邏輯，必須與主儀表板保持一致
2. **效能考量**：封面頁會在資料載入完成後才顯示內容
3. **錯誤處理**：即使資料載入失敗，仍可進入系統
4. **瀏覽器支援**：需支援 ES6+ 和 CSS Grid

## 未來擴充

可考慮的增強功能：

- 添加更多動態數據指標
- 支援深色/淺色主題切換
- 加入資料更新時間戳記
- 提供快速行動入口（直接跳轉至風險客群頁面）
