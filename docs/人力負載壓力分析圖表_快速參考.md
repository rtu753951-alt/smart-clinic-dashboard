# 人力負載壓力分析圖表 - 快速參考

## 🎯 核心變更

### 工時計算公式

```
總工時 = 職務人數 × 8小時/天 × 7天/週 × 4週/月
實際工時 = Σ(療程時間 × 介入比例)
負載率 = (實際工時 / 總工時) × 100%
```

### 預約篩選規則（基準日：2025-12-16）

| 時間範圍       | 篩選條件             |
| -------------- | -------------------- |
| **今天之前**   | 只計算 `completed`   |
| **今天及之後** | 全部納入（不管狀態） |

### 醫師介入比例

| 療程類型     | 醫師 | 諮詢師 | 美療師 | 護理師 |
| ------------ | ---- | ------ | ------ | ------ |
| Inject/RF    | 35%  | -      | -      | -      |
| Laser        | 15%  | -      | 100%   | -      |
| Drip         | 10%  | -      | -      | 100%   |
| Consultation | 30%  | 70%    | -      | -      |

## 📁 修改檔案

### 新增

- `src/logic/staff/staffWorkloadChart.ts` - 圖表模組

### 修改

- `index.html` (Line 477-496) - Canvas 元素
- `src/pages/staffPage.ts` (Line 6, 20-21) - 初始化邏輯

## 🎨 圖表規格

- **類型**: 分組柱狀圖
- **資料集**: 實際工時 + 總工時
- **同步**: 與全域月份選單同步
- **字體**: Noto Sans TC（繁體中文）

## 💡 計算範例

```typescript
// Botox (inject, 20分鐘)
醫師等效工時 = 20 × 0.35 = 7 分鐘

// 醫師總工時（4人）
總工時 = 4 × 8 × 7 × 4 = 896 小時

// 負載率
負載率 = (實際工時 / 896) × 100%
```

## ✅ 驗證

```bash
npm run build  # 編譯成功 ✓
```

## 🚀 使用

1. 開啟「人力分析」頁面
2. 查看圖表（自動顯示當前月份）
3. 切換月份（右上方選單）
4. 滑鼠移到柱狀圖查看詳情

---

**更新日期**: 2025-12-16  
**版本**: v2.0
